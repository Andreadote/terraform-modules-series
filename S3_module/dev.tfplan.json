{"format_version":"0.1","terraform_version":"0.14.9","variables":{"aws_region":{"value":"us-west-2"},"aws_s3_bucket":{"value":"dev"},"bucket_versioning":{"value":"Enabled"},"tesla_vpc":{"value":true}},"planned_values":{"outputs":{"s3_tesla_bucket_name":{"sensitive":false}},"root_module":{"resources":[{"address":"aws_kms_key.tesla_key","mode":"managed","type":"aws_kms_key","name":"tesla_key","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"bypass_policy_lockout_safety_check":false,"custom_key_store_id":null,"customer_master_key_spec":"SYMMETRIC_DEFAULT","deletion_window_in_days":10,"description":"Key used to encrypt bucket objects","enable_key_rotation":true,"is_enabled":true,"key_usage":"ENCRYPT_DECRYPT","policy":"{\"Id\":\"key-default-1\",\"Statement\":[{\"Action\":\"kms:*\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"*\"},\"Resource\":\"*\",\"Sid\":\"Enable IAM User Permissions\"}],\"Version\":\"2012-10-17\"}","tags":null}},{"address":"aws_s3_bucket.tesla_bucket[0]","mode":"managed","type":"aws_s3_bucket","name":"tesla_bucket","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"force_destroy":false,"server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":"alias/aws/s3","sse_algorithm":"aws:kms"}],"bucket_key_enabled":null}]}],"tags":{"Environment":"Production","Name":"MyS3Bucket"},"tags_all":{"Environment":"Production","Name":"MyS3Bucket"},"timeouts":null,"versioning":[{"enabled":true,"mfa_delete":false}]}},{"address":"aws_s3_bucket_lifecycle_configuration.tesla_event_lifecycle","mode":"managed","type":"aws_s3_bucket_lifecycle_configuration","name":"tesla_event_lifecycle","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"rule":[{"abort_incomplete_multipart_upload":[],"expiration":[],"filter":[],"id":"example-event-rule","noncurrent_version_expiration":[],"noncurrent_version_transition":[],"prefix":null,"status":"Enabled","transition":[{"date":"","days":30,"storage_class":"STANDARD_IA"},{"date":"","days":60,"storage_class":"GLACIER"}]}]}},{"address":"aws_s3_bucket_lifecycle_configuration.tesla_lifecycle","mode":"managed","type":"aws_s3_bucket_lifecycle_configuration","name":"tesla_lifecycle","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"rule":[{"abort_incomplete_multipart_upload":[{"days_after_initiation":7}],"expiration":[],"filter":[],"id":"abort-incomplete-multipart-upload","noncurrent_version_expiration":[],"noncurrent_version_transition":[],"prefix":null,"status":"Enabled","transition":[]},{"abort_incomplete_multipart_upload":[],"expiration":[],"filter":[{"and":[],"object_size_greater_than":null,"object_size_less_than":null,"prefix":"","tag":[]}],"id":"example-rule","noncurrent_version_expiration":[],"noncurrent_version_transition":[],"prefix":null,"status":"Enabled","transition":[{"date":"","days":30,"storage_class":"STANDARD_IA"},{"date":"","days":60,"storage_class":"GLACIER"}]}]}},{"address":"aws_s3_bucket_logging.example_logging","mode":"managed","type":"aws_s3_bucket_logging","name":"example_logging","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"target_bucket":"log-bucket","target_grant":[],"target_prefix":"log/"}},{"address":"aws_s3_bucket_notification.bucket_notification","mode":"managed","type":"aws_s3_bucket_notification","name":"bucket_notification","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"eventbridge":false,"lambda_function":[{"events":["s3:ObjectCreated:*"],"filter_prefix":"uploads/","filter_suffix":".jpg","lambda_function_arn":"arn:aws:lambda:us-east-1:123456789012:function:my-function"}],"queue":[],"topic":[]}},{"address":"aws_s3_bucket_public_access_block.tesla_bucket","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"tesla_bucket","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"restrict_public_buckets":true}},{"address":"aws_s3_bucket_replication_configuration.tesla_replication","mode":"managed","type":"aws_s3_bucket_replication_configuration","name":"tesla_replication","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"role":"arn:aws:iam::109753259968:role/replica","rule":[{"delete_marker_replication":[],"destination":[{"access_control_translation":[],"account":null,"bucket":"arn:aws:s3:::elasticbeanstalk-ca-central-1-109753259968","encryption_configuration":[],"metrics":[],"replication_time":[],"storage_class":"STANDARD"}],"existing_object_replication":[],"filter":[],"id":"tesla-replication-rule","prefix":null,"priority":1,"source_selection_criteria":[{"replica_modifications":[],"sse_kms_encrypted_objects":[{"status":"Enabled"}]}],"status":"Enabled"}],"token":null}},{"address":"random_integer.tesla_bucket[0]","mode":"managed","type":"random_integer","name":"tesla_bucket","index":0,"provider_name":"registry.terraform.io/hashicorp/random","schema_version":0,"values":{"keepers":{"Environment":"dev"},"max":500,"min":1,"seed":null}}]}},"resource_changes":[{"address":"aws_kms_key.tesla_key","mode":"managed","type":"aws_kms_key","name":"tesla_key","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"bypass_policy_lockout_safety_check":false,"custom_key_store_id":null,"customer_master_key_spec":"SYMMETRIC_DEFAULT","deletion_window_in_days":10,"description":"Key used to encrypt bucket objects","enable_key_rotation":true,"is_enabled":true,"key_usage":"ENCRYPT_DECRYPT","policy":"{\"Id\":\"key-default-1\",\"Statement\":[{\"Action\":\"kms:*\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"*\"},\"Resource\":\"*\",\"Sid\":\"Enable IAM User Permissions\"}],\"Version\":\"2012-10-17\"}","tags":null},"after_unknown":{"arn":true,"id":true,"key_id":true,"multi_region":true,"tags_all":true}}},{"address":"aws_s3_bucket.tesla_bucket[0]","mode":"managed","type":"aws_s3_bucket","name":"tesla_bucket","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"force_destroy":false,"server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":"alias/aws/s3","sse_algorithm":"aws:kms"}],"bucket_key_enabled":null}]}],"tags":{"Environment":"Production","Name":"MyS3Bucket"},"tags_all":{"Environment":"Production","Name":"MyS3Bucket"},"timeouts":null,"versioning":[{"enabled":true,"mfa_delete":false}]},"after_unknown":{"acceleration_status":true,"acl":true,"arn":true,"bucket":true,"bucket_domain_name":true,"bucket_prefix":true,"bucket_regional_domain_name":true,"cors_rule":true,"grant":true,"hosted_zone_id":true,"id":true,"lifecycle_rule":true,"logging":true,"object_lock_configuration":true,"object_lock_enabled":true,"policy":true,"region":true,"replication_configuration":true,"request_payer":true,"server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}],"tags":{},"tags_all":{},"versioning":[{}],"website":true,"website_domain":true,"website_endpoint":true}}},{"address":"aws_s3_bucket_lifecycle_configuration.tesla_event_lifecycle","mode":"managed","type":"aws_s3_bucket_lifecycle_configuration","name":"tesla_event_lifecycle","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"rule":[{"abort_incomplete_multipart_upload":[],"expiration":[],"filter":[],"id":"example-event-rule","noncurrent_version_expiration":[],"noncurrent_version_transition":[],"prefix":null,"status":"Enabled","transition":[{"date":"","days":30,"storage_class":"STANDARD_IA"},{"date":"","days":60,"storage_class":"GLACIER"}]}]},"after_unknown":{"bucket":true,"id":true,"rule":[{"abort_incomplete_multipart_upload":[],"expiration":[],"filter":[],"noncurrent_version_expiration":[],"noncurrent_version_transition":[],"transition":[{},{}]}]}}},{"address":"aws_s3_bucket_lifecycle_configuration.tesla_lifecycle","mode":"managed","type":"aws_s3_bucket_lifecycle_configuration","name":"tesla_lifecycle","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"rule":[{"abort_incomplete_multipart_upload":[{"days_after_initiation":7}],"expiration":[],"filter":[],"id":"abort-incomplete-multipart-upload","noncurrent_version_expiration":[],"noncurrent_version_transition":[],"prefix":null,"status":"Enabled","transition":[]},{"abort_incomplete_multipart_upload":[],"expiration":[],"filter":[{"and":[],"object_size_greater_than":null,"object_size_less_than":null,"prefix":"","tag":[]}],"id":"example-rule","noncurrent_version_expiration":[],"noncurrent_version_transition":[],"prefix":null,"status":"Enabled","transition":[{"date":"","days":30,"storage_class":"STANDARD_IA"},{"date":"","days":60,"storage_class":"GLACIER"}]}]},"after_unknown":{"bucket":true,"id":true,"rule":[{"abort_incomplete_multipart_upload":[{}],"expiration":[],"filter":[],"noncurrent_version_expiration":[],"noncurrent_version_transition":[],"transition":[]},{"abort_incomplete_multipart_upload":[],"expiration":[],"filter":[{"and":[],"tag":[]}],"noncurrent_version_expiration":[],"noncurrent_version_transition":[],"transition":[{},{}]}]}}},{"address":"aws_s3_bucket_logging.example_logging","mode":"managed","type":"aws_s3_bucket_logging","name":"example_logging","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"target_bucket":"log-bucket","target_grant":[],"target_prefix":"log/"},"after_unknown":{"bucket":true,"id":true,"target_grant":[]}}},{"address":"aws_s3_bucket_notification.bucket_notification","mode":"managed","type":"aws_s3_bucket_notification","name":"bucket_notification","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"eventbridge":false,"lambda_function":[{"events":["s3:ObjectCreated:*"],"filter_prefix":"uploads/","filter_suffix":".jpg","lambda_function_arn":"arn:aws:lambda:us-east-1:123456789012:function:my-function"}],"queue":[],"topic":[]},"after_unknown":{"bucket":true,"id":true,"lambda_function":[{"events":[false],"id":true}],"queue":[],"topic":[]}}},{"address":"aws_s3_bucket_public_access_block.tesla_bucket","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"tesla_bucket","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"restrict_public_buckets":true},"after_unknown":{"bucket":true,"id":true}}},{"address":"aws_s3_bucket_replication_configuration.tesla_replication","mode":"managed","type":"aws_s3_bucket_replication_configuration","name":"tesla_replication","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"role":"arn:aws:iam::109753259968:role/replica","rule":[{"delete_marker_replication":[],"destination":[{"access_control_translation":[],"account":null,"bucket":"arn:aws:s3:::elasticbeanstalk-ca-central-1-109753259968","encryption_configuration":[],"metrics":[],"replication_time":[],"storage_class":"STANDARD"}],"existing_object_replication":[],"filter":[],"id":"tesla-replication-rule","prefix":null,"priority":1,"source_selection_criteria":[{"replica_modifications":[],"sse_kms_encrypted_objects":[{"status":"Enabled"}]}],"status":"Enabled"}],"token":null},"after_unknown":{"bucket":true,"id":true,"rule":[{"delete_marker_replication":[],"destination":[{"access_control_translation":[],"encryption_configuration":[],"metrics":[],"replication_time":[]}],"existing_object_replication":[],"filter":[],"source_selection_criteria":[{"replica_modifications":[],"sse_kms_encrypted_objects":[{}]}]}]}}},{"address":"random_integer.tesla_bucket[0]","mode":"managed","type":"random_integer","name":"tesla_bucket","index":0,"provider_name":"registry.terraform.io/hashicorp/random","change":{"actions":["create"],"before":null,"after":{"keepers":{"Environment":"dev"},"max":500,"min":1,"seed":null},"after_unknown":{"id":true,"keepers":{},"result":true}}}],"output_changes":{"s3_tesla_bucket_name":{"actions":["create"],"before":null,"after_unknown":true}},"configuration":{"provider_config":{"aws":{"name":"aws","expressions":{"region":{"references":["var.aws_region"]}}}},"root_module":{"outputs":{"s3_tesla_bucket_name":{"expression":{"references":["aws_s3_bucket.tesla_bucket[0]"]}}},"resources":[{"address":"aws_kms_key.tesla_key","mode":"managed","type":"aws_kms_key","name":"tesla_key","provider_config_key":"aws","expressions":{"deletion_window_in_days":{"constant_value":10},"description":{"constant_value":"Key used to encrypt bucket objects"},"enable_key_rotation":{"constant_value":true},"is_enabled":{"constant_value":true},"policy":{"constant_value":"{\n  \"Version\": \"2012-10-17\",\n  \"Id\": \"key-default-1\",\n  \"Statement\": [\n    {\n      \"Sid\": \"Enable IAM User Permissions\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"AWS\": \"*\"\n      },\n      \"Action\": \"kms:*\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\n"}},"schema_version":0},{"address":"aws_s3_bucket.tesla_bucket","mode":"managed","type":"aws_s3_bucket","name":"tesla_bucket","provider_config_key":"aws","expressions":{"bucket":{"references":["var.aws_s3_bucket","random_integer.tesla_bucket[0]"]},"server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":{"constant_value":"alias/aws/s3"},"sse_algorithm":{"constant_value":"aws:kms"}}]}]}],"tags":{"constant_value":{"Environment":"Production","Name":"MyS3Bucket"}},"versioning":[{"enabled":{"constant_value":true}}]},"schema_version":0,"count_expression":{"references":["var.tesla_vpc"]}},{"address":"aws_s3_bucket_lifecycle_configuration.tesla_event_lifecycle","mode":"managed","type":"aws_s3_bucket_lifecycle_configuration","name":"tesla_event_lifecycle","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.tesla_bucket[0]"]},"rule":[{"id":{"constant_value":"example-event-rule"},"status":{"constant_value":"Enabled"},"transition":[{"days":{"constant_value":30},"storage_class":{"constant_value":"STANDARD_IA"}},{"days":{"constant_value":60},"storage_class":{"constant_value":"GLACIER"}}]}]},"schema_version":0},{"address":"aws_s3_bucket_lifecycle_configuration.tesla_lifecycle","mode":"managed","type":"aws_s3_bucket_lifecycle_configuration","name":"tesla_lifecycle","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.tesla_bucket[0]"]},"rule":[{"abort_incomplete_multipart_upload":[{"days_after_initiation":{"constant_value":7}}],"id":{"constant_value":"abort-incomplete-multipart-upload"},"status":{"constant_value":"Enabled"}},{"filter":[{"prefix":{"constant_value":""}}],"id":{"constant_value":"example-rule"},"status":{"constant_value":"Enabled"},"transition":[{"days":{"constant_value":30},"storage_class":{"constant_value":"STANDARD_IA"}},{"days":{"constant_value":60},"storage_class":{"constant_value":"GLACIER"}}]}]},"schema_version":0},{"address":"aws_s3_bucket_logging.example_logging","mode":"managed","type":"aws_s3_bucket_logging","name":"example_logging","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.tesla_bucket[0]"]},"target_bucket":{"constant_value":"log-bucket"},"target_prefix":{"constant_value":"log/"}},"schema_version":0},{"address":"aws_s3_bucket_notification.bucket_notification","mode":"managed","type":"aws_s3_bucket_notification","name":"bucket_notification","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.tesla_bucket[0]"]},"lambda_function":[{"events":{"constant_value":["s3:ObjectCreated:*"]},"filter_prefix":{"constant_value":"uploads/"},"filter_suffix":{"constant_value":".jpg"},"lambda_function_arn":{"constant_value":"arn:aws:lambda:us-east-1:123456789012:function:my-function"}}]},"schema_version":0},{"address":"aws_s3_bucket_public_access_block.tesla_bucket","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"tesla_bucket","provider_config_key":"aws","expressions":{"block_public_acls":{"constant_value":true},"block_public_policy":{"constant_value":true},"bucket":{"references":["aws_s3_bucket.tesla_bucket[0]"]},"ignore_public_acls":{"constant_value":true},"restrict_public_buckets":{"constant_value":true}},"schema_version":0},{"address":"aws_s3_bucket_replication_configuration.tesla_replication","mode":"managed","type":"aws_s3_bucket_replication_configuration","name":"tesla_replication","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.tesla_bucket[0]"]},"role":{"constant_value":"arn:aws:iam::109753259968:role/replica"},"rule":[{"destination":[{"bucket":{"constant_value":"arn:aws:s3:::elasticbeanstalk-ca-central-1-109753259968"},"storage_class":{"constant_value":"STANDARD"}}],"id":{"constant_value":"tesla-replication-rule"},"priority":{"constant_value":1},"source_selection_criteria":[{"sse_kms_encrypted_objects":[{"status":{"constant_value":"Enabled"}}]}],"status":{"constant_value":"Enabled"}}]},"schema_version":0},{"address":"random_integer.tesla_bucket","mode":"managed","type":"random_integer","name":"tesla_bucket","provider_config_key":"random","expressions":{"keepers":{"references":["var.aws_s3_bucket"]},"max":{"constant_value":500},"min":{"constant_value":1}},"schema_version":0,"count_expression":{"references":["var.tesla_vpc"]}}],"variables":{"aws_region":{"default":"us-west-2"},"aws_s3_bucket":{"default":"dev"},"bucket_versioning":{"default":"Enabled"},"tesla_vpc":{"default":true}}}}}
